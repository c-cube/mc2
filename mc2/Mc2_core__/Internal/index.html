<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Internal (mc2.Mc2_core__.Internal)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">mc2</a> &#x00BB; <a href="../index.html">Mc2_core__</a> &#x00BB; Internal</nav><h1>Module <code>Mc2_core__.Internal</code></h1><nav class="toc"><ul><li><a href="#solving-facilities">Solving facilities</a></li><li><a href="#proofs-and-models">Proofs and Models</a></li><li><a href="#internal-data">Internal data</a></li></ul></nav></header><aside><p>mSAT core</p><p>This is the core of msat, containing the code doing the actual solving. This module is based on mini-sat, and as such the solver heavily uses mutation, which makes using it direclty kinda tricky (some exceptions can be raised at surprising times, mutating is dangerous for maintaining invariants, etc...).</p></aside><section><header><h3 id="solving-facilities"><a href="#solving-facilities" class="anchor"></a>Solving facilities</h3></header><dl><dt class="spec exception" id="exception-Unsat"><a href="#exception-Unsat" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Unsat</span></code></dt><dt class="spec exception" id="exception-UndecidedLit"><a href="#exception-UndecidedLit" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">UndecidedLit</span> <span class="keyword">of</span> <a href="../Solver_types/index.html#type-term">Mc2_core__.Solver_types.term</a></code></dt><dt class="spec exception" id="exception-Out_of_time"><a href="#exception-Out_of_time" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Out_of_time</span></code></dt><dt class="spec exception" id="exception-Out_of_space"><a href="#exception-Out_of_space" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Out_of_space</span></code></dt></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dd><p>The core solver structure</p></dd></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : unit <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Create a solver</p></dd></dl><dl><dt class="spec value" id="val-add_plugin"><a href="#val-add_plugin" class="anchor"></a><code><span class="keyword">val</span> add_plugin : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../Mc2_core/Plugin/Factory/index.html#type-t">Mc2_core.Plugin.Factory.t</a> <span>&#45;&gt;</span> <a href="../../Mc2_core/Plugin/index.html#type-t">Mc2_core.Plugin.t</a></code></dt><dd><p><code>add_plugin s f</code> creates a new plugin, stores it into <code>s</code>, and returns it.</p><dl><dt>raises Failure</dt><dd><p>if all plugin IDs have been allocated</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-plugins"><a href="#val-plugins" class="anchor"></a><code><span class="keyword">val</span> plugins : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../../Mc2_core/Plugin/index.html#type-t">Mc2_core.Plugin.t</a> Iter.t</span></code></dt><dt class="spec value" id="val-get_plugin"><a href="#val-get_plugin" class="anchor"></a><code><span class="keyword">val</span> get_plugin : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Solver_types/index.html#type-plugin_id">Mc2_core__.Solver_types.plugin_id</a> <span>&#45;&gt;</span> <a href="../../Mc2_core/Plugin/index.html#type-t">Mc2_core.Plugin.t</a></code></dt><dd><p>Get the plugin from its ID</p></dd></dl><dl><dt class="spec value" id="val-services"><a href="#val-services" class="anchor"></a><code><span class="keyword">val</span> services : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../Mc2_core/Service/Registry/index.html#type-t">Mc2_core.Service.Registry.t</a></code></dt><dd><p>Service registry</p></dd></dl><dl><dt class="spec value" id="val-get_service"><a href="#val-get_service" class="anchor"></a><code><span class="keyword">val</span> get_service : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="../../Mc2_core/Service/Key/index.html#type-t">Mc2_core.Service.Key.t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> option</span></code></dt><dd><p>Obtain a service by its key</p></dd></dl><dl><dt class="spec value" id="val-get_service_exn"><a href="#val-get_service_exn" class="anchor"></a><code><span class="keyword">val</span> get_service_exn : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="../../Mc2_core/Service/Key/index.html#type-t">Mc2_core.Service.Key.t</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Obtain a service by its key</p></dd></dl><dl><dt class="spec value" id="val-actions"><a href="#val-actions" class="anchor"></a><code><span class="keyword">val</span> actions : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Solver_types/index.html#type-actions">Mc2_core__.Solver_types.actions</a></code></dt><dd><p>Actions available to plugins</p></dd></dl><dl><dt class="spec value" id="val-iter_terms"><a href="#val-iter_terms" class="anchor"></a><code><span class="keyword">val</span> iter_terms : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../Solver_types/index.html#type-term">Mc2_core__.Solver_types.term</a> Iter.t</span></code></dt><dd><p>Iterate on all terms known to plugins. Used for checking all variables to assign, and for garbage collection.</p></dd></dl><dl><dt class="spec value" id="val-solve"><a href="#val-solve" class="anchor"></a><code><span class="keyword">val</span> solve : <span>?&#8288;gc:bool</span> <span>&#45;&gt;</span> <span>?&#8288;restarts:bool</span> <span>&#45;&gt;</span> <span>?&#8288;time:float</span> <span>&#45;&gt;</span> <span>?&#8288;memory:float</span> <span>&#45;&gt;</span> <span>?&#8288;progress:bool</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Try and solves the current set of assumptions.</p><dl><dt>parameter time</dt><dd><p>limit, in seconds, measured with <code>Sys.time()</code></p></dd></dl><dl><dt>parameter memory</dt><dd><p>number of words in the heap</p></dd></dl><dl><dt>returns</dt><dd><p>() if the current set of clauses is satisfiable</p></dd></dl><dl><dt>raises Unsat</dt><dd><p>if a toplevel conflict is found</p></dd></dl><dl><dt>raises Out_of_time</dt><dd><p>if out of time</p></dd></dl><dl><dt>raises Out_of_space</dt><dd><p>if out of space</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-assume"><a href="#val-assume" class="anchor"></a><code><span class="keyword">val</span> assume : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>?&#8288;tag:int</span> <span>&#45;&gt;</span> <span><span><a href="../Solver_types/index.html#type-atom">Mc2_core__.Solver_types.atom</a> list</span> list</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Add the list of clauses to the current set of assumptions. Modifies the sat solver state in place.</p></dd></dl><dl><dt class="spec value" id="val-add_term"><a href="#val-add_term" class="anchor"></a><code><span class="keyword">val</span> add_term : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Solver_types/index.html#type-term">Mc2_core__.Solver_types.term</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Add a new generalized variable (i.e term) to the solver. This term will be decided on at some point during solving, wether it appears in clauses or not.</p></dd></dl><dl><dt class="spec value" id="val-push"><a href="#val-push" class="anchor"></a><code><span class="keyword">val</span> push : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Create a decision level for local assumptions.</p><dl><dt>raises Unsat</dt><dd><p>if a conflict is detected in the current state.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-pop"><a href="#val-pop" class="anchor"></a><code><span class="keyword">val</span> pop : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Pop a decision level for local assumptions.</p></dd></dl><dl><dt class="spec value" id="val-local"><a href="#val-local" class="anchor"></a><code><span class="keyword">val</span> local : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../Solver_types/index.html#type-atom">Mc2_core__.Solver_types.atom</a> list</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Add local assumptions</p><dl><dt>parameter assumptions</dt><dd><p>list of additional local assumptions to make, removed after the callback returns a value</p></dd></dl><dl><dt>raises Invalid_argument</dt><dd><p>if no levels were <a href="index.html#val-push"><code>push</code></a>ed</p></dd></dl></dd></dl></section><section><header><h3 id="proofs-and-models"><a href="#proofs-and-models" class="anchor"></a>Proofs and Models</h3></header><dl><dt class="spec value" id="val-eval"><a href="#val-eval" class="anchor"></a><code><span class="keyword">val</span> eval : <a href="../Solver_types/index.html#type-atom">Mc2_core__.Solver_types.atom</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Returns the valuation of a term in the current state of the sat solver.</p><dl><dt>raises UndecidedLit</dt><dd><p>if the literal is not decided</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-eval_level"><a href="#val-eval_level" class="anchor"></a><code><span class="keyword">val</span> eval_level : <a href="../Solver_types/index.html#type-atom">Mc2_core__.Solver_types.atom</a> <span>&#45;&gt;</span> bool * int</code></dt><dd><p>Return the current assignement/evaluation of the boolean term, as well as its decision level. If the level is 0, then it is necessary for the atom to have this value; otherwise it is due to choices that can potentially be backtracked.</p><dl><dt>raises UndecidedLit</dt><dd><p>if the literal is not decided not calculable</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-model"><a href="#val-model" class="anchor"></a><code><span class="keyword">val</span> model : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../Solver_types/index.html#type-assignment_view">Mc2_core__.Solver_types.assignment_view</a> list</span></code></dt><dd><p>Returns the model found if the term is satisfiable.</p></dd></dl><dl><dt class="spec value" id="val-check"><a href="#val-check" class="anchor"></a><code><span class="keyword">val</span> check : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span>(unit, string)</span> Pervasives.result</span></code></dt><dd><p>Check the satisfiability of the current model. Only has meaning if the solver finished proof search and has returned <code>Sat</code>.</p></dd></dl><dl><dt class="spec type" id="type-proof"><a href="#type-proof" class="anchor"></a><code><span class="keyword">type</span> proof</code><code> = <a href="../../Mc2_core/Proof/index.html#type-t">Mc2_core.Proof.t</a></code></dt></dl><dl><dt class="spec value" id="val-unsat_conflict"><a href="#val-unsat_conflict" class="anchor"></a><code><span class="keyword">val</span> unsat_conflict : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../Solver_types/index.html#type-clause">Mc2_core__.Solver_types.clause</a> option</span></code></dt><dd><p>Returns the unsat clause found at the toplevel, if it exists (i.e if <code>solve</code> has raised <code>Unsat</code>)</p></dd></dl></section><section><header><h3 id="internal-data"><a href="#internal-data" class="anchor"></a>Internal data</h3><p>These functions expose some internal data stored by the solver, as such great care should be taken to ensure not to mess with the values returned.</p></header><dl><dt class="spec value" id="val-trail"><a href="#val-trail" class="anchor"></a><code><span class="keyword">val</span> trail : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Solver_types/index.html#type-trail">Mc2_core__.Solver_types.trail</a></code></dt><dd><p>Returns the current trail. <b>DO NOT MUTATE</b></p></dd></dl><dl><dt class="spec value" id="val-hyps"><a href="#val-hyps" class="anchor"></a><code><span class="keyword">val</span> hyps : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../Solver_types/index.html#type-clause">Mc2_core__.Solver_types.clause</a> <a href="../Vec/index.html#type-t">Mc2_core__.Vec.t</a></span></code></dt><dd><p>Returns the vector of assumptions used by the solver. May be slightly different from the clauses assumed because of top-level simplification of clauses. <b>DO NOT MUTATE</b></p></dd></dl><dl><dt class="spec value" id="val-temp"><a href="#val-temp" class="anchor"></a><code><span class="keyword">val</span> temp : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../Solver_types/index.html#type-clause">Mc2_core__.Solver_types.clause</a> <a href="../Vec/index.html#type-t">Mc2_core__.Vec.t</a></span></code></dt><dd><p>Returns the clauses coreesponding to the local assumptions. All clauses in this vec are assured to be unit clauses. <b>DO NOT MUTATE</b></p></dd></dl><dl><dt class="spec value" id="val-history"><a href="#val-history" class="anchor"></a><code><span class="keyword">val</span> history : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../Solver_types/index.html#type-clause">Mc2_core__.Solver_types.clause</a> <a href="../Vec/index.html#type-t">Mc2_core__.Vec.t</a></span></code></dt><dd><p>Returns the history of learnt clauses, with no guarantees on order. <b>DO NOT MUTATE</b></p></dd></dl><dl><dt class="spec value" id="val-pp_stats"><a href="#val-pp_stats" class="anchor"></a><code><span class="keyword">val</span> pp_stats : <span><a href="index.html#type-t">t</a> CCFormat.printer</span></code></dt><dt class="spec value" id="val-clear_progress"><a href="#val-clear_progress" class="anchor"></a><code><span class="keyword">val</span> clear_progress : unit <span>&#45;&gt;</span> unit</code></dt><dd><p>Clear progress bar</p></dd></dl></section></div></body></html>